<HTML>
<CENTER><A HREF = "http://dsmc.sandia.gov">SPARTA WWW Site</A> - <A HREF = "Manual.html">SPARTA Documentation</A> - <A HREF = "Section_commands.html#comm">SPARTA Commands</A> 
</CENTER>






<HR>

<H3>create_grid command 
</H3>
<P><B>Syntax:</B>
</P>
<PRE>create_grid Nx Ny Nz level args ... 
</PRE>
<UL><LI>Nx,Ny,Nz = size of 1st-level grid in each dimension 
</UL>
<LI>zero or more level/args pairs may be appended 

<LI>level = 2 to Nlevel in ascending order 

<LI>args = Px Py Pz Cx Cy Cz 

<PRE>  Px Py Pz = range of parent cells in each dimension in which to create child cells
  Cx Cy Cz = size of child grid in each dimension 
</PRE>

</UL>
<P><B>Examples:</B>
</P>
<PRE>create_grid 10 10 10
create_grid 10 10 10 2 * * * 2 2 3
create_grid 8 8 10 2 5* * * 4 4 4 3 1 2*3 3* 2 2 1 
</PRE>
<P><B>Description:</B>
</P>
<P>Overlay a uniform or hierarchical grid over the simulation domain
defined by the <A HREF = "create_box.html">create_box</A> command.  The grid can
also be defined by the <A HREF = "read_grid.html">read_grid</A> command.
</P>
<P>When a uniform or hierarchical grid is created it contains 1 or more
parent cells, and some number of child cells.  Parent cells have
children; child cells do not.  In the current SPARTA implementation,
all processors own a copy of all parent cells.  The child cells are
each owned by a unique processor; they are assigned by this command to
processors in a round-robin fashion, as they are created.  The
<A HREF = "balance_grid.html">balance_grid</A> command can be used after the grid is
defined, to assign them to processors in a more structured manner.
</P>
<HR>

<P>A uniform grid is a hierarchical grid with a single level.  It is
defined by specifying only the arguments <I>Nx</I>, <I>Ny</I>, <I>Nz</I>, with no
additional levels.  This will create a Nx by Ny by Nz grid.  For 2d
simulations, <I>Nz</I> must equal 1.  A uniform grid has 1 parent cell (the
entire simulation box) and Nx*Ny*Nz child cells, e.g. 1000 child cells
in the first example above.
</P>
<P>If a hierarchical grid with more levels is desired, they can be
defined in ascending order, starting with level 2.  The Px, Py, Pz
arguments specify which cells in the previous level are flagged as
parents and partitioned to create cells at the new level.  Each of the
Px, Py, Pz arguments can be a single number or be specified with a
wildcard asterisk, as in the examples above.  For example, Px can be
specified as "*" or "*n" or "n*" or "m*n".  If N = the number of grid
cells in the x-direction in the previous level as defined by Nx (or
Cx), then an asterisk with no numeric values means all cells with
indices from 1 to N.  A leading asterisk means all indices from 1 to n
(inclusive).  A trailing asterisk means all indices from n to N
(inclusive).  A middle asterisk means all indices from m to n
(inclusive).
</P>
<P>The Cx, Cy, Cz arguments are the number of new cells (in each
dimension) to partition each parent cell into.  For 2d simulations,
<I>Cz</I> must equal 1.  Note that for each new level, only grid cells that
exist in the previous level are partitioned further.  E.g. level 3
cells are only added to level 2 cells that exist, since some level 1
cells may not have been partitioned into level 2 cells.
</P>
<P>The 2nd example above creates a 2-level grid.  The 1st level is
10x10x10.  Each of the 1000 level 1 cells is further partitioned into
2x2x3 cells.  This means the total number of level 2 cells is 1000 *
12 = 12000.  The final grid in this example thus has 1001 parent cells
(the simulation box plus the 1000 level 1 cells), and 12000 child
cells.
</P>
<P>The 3rd example above creates a 3-level grid.  The 1st level is
8x8x10.  The 2nd level is 4x4x4 within each 1st level cell, but only
half or 320 of the 640 level 1 cells are partitioned, namely those
with x indices from 5 to 8.  Those with x indices from 1 to 4 remain
as level 1 cells.  Some of the level 2 cells are further partitioned
into 2x2x1 level 3 cells.  For the 4x4x4 level 2 grid within 320 or
the level 1 cells, only the level 2 cells with x index = 1, y index =
2-3, and z-index = 3-4 are further partitioned into level 3 cells,
which is just 4 of the 64 level 2 cells.
</P>
<P>The final grid in the 3rd example thus has 1601 parent cells: 1 for
the simulation box, 320 level 1 cells, and 1280 level 2 cells.  It has
24640 child cells: 320 level 1 cells, 19200 level 2 cells, and 5120
level 3 cells.
</P>
<P><B>Restrictions:</B>
</P>
<P>This command can only be used after the simulation box is defined by
the <A HREF = "create_box.html">create_box</A> command.
</P>
<P>In principle, the hierarchical grid used by SPARTA can have as many
levels as you wish.  Internally, the hierarchy corresponding to each
grid cell is converted into a 64-bit integer ID.  Explain it further.
Practically speaking this means you are limited to about 8 levels.
</P>
<P><B>Related commands:</B>
</P>
<P><A HREF = "create_box.html">create_box</A>, <A HREF = "read_grid.html">read_grid</A>
</P>
<P><B>Default:</B> none
</P>
</HTML>
