"SPARTA WWW Site"_sws - "SPARTA Documentation"_sd - "SPARTA Commands"_sc :c

:link(sws,http://dsmc.sandia.gov)
:link(sd,Manual.html)
:link(sc,Section_commands.html#comm)

:line

create_molecules command :h3

[Syntax:]

create_molecules mix-ID keyword value ... :pre

mix-ID = ID of mixture to use when creating molecules :ulb,l
zero or more keyword/value pairs may be appended :l
keyword = {n} or {single} :l
  {n} value = Np = number of molecules to create
  {single} values = species-ID x y z vx vy vz
    species-ID = ID of species of single molecule
    x,y,z = position of molecule (distance units)
    vx,vy,vz = velocity of molecule (velocity units) :pre
:ule

[Examples:]

create_molecules background
create_molecules air n 100000
create_molecules air single N 5 5 5 10 -1 0 :pre

[Description:]

Create or add additional molecules to the simulation domain.  The
number of molecules created and their individual attributes, such
species and velocity, are determined by the mixture attributes, as
specied by the {mix-ID}.  See the "mixture"_mixture.html command for
more details.

If the {n} keyword is used with a {Np} value of 0, then {Np} is
calculated by SPARTA as a function of the global {Fnum} value, the
mixture number density, and the volume of the simulation domain.  The
{Fnum} value is set by the "global fnum"_global.html command.  The
mixture {nrho} is set by the "mixture"_mixture.html command.  The
volume of the simulation is set by the "create_box"_create_box.html
command.

If the {n} keyword is used with a non-zero {Np} value, then exactly
{Np} particles will be created, which can be useful for debugging
or benchmarking purposes.

Based on the value of {Np}, each grid cell will have a target number
of molecules {M} to insert, which is a function of the cell's volume
as compared to the total system volume.  If {M} has a fractional
value, e.g. 12.5, then 12 molecules will be inserted, and a 13th
depending on the outcome of a random number generation.  As grid cells
are looped over, the remainder fraction is accumulated, so that
exactly {Np} particles are created across all the processors.

Each molecule is inserted at a random location within the grid cell.
The molecule species is chosen randomly in accord with the {frac}
settings of the collection of species in the mixture, as set by the
"mixture"_mixture.html command.  The velocity of the molecule is set
to the sum of the streaming velocity of the mixture and a thermal
velocity sampled from the thermal temperature of the mixture.  Both
the streaming velocity and thermal temperature are also set by the
"mixture"_mixture.html command.

The {n} keyword can be useful for debugging purposes.  If {Np} is set
to 0, then the count of created particles is a function of the {Fnum}
and {nrho} and other mixture settings, as described above.  If {Np} is
set to a value > 0, then the {Fnum} and {nrho} settings are ignored,
and {Np} molecules are created.  The assignment of species and
velocity to each molecules is done the same as described above.

The {single} keyword can also be useful for debugging purposes,
e.g. to advect a single particle towards a surface.  A single particle
of the specified species is inserted at the specified position and
with the specified velocity.  In this case the {mix-ID} is ignored.

:line

NOTE: the {loop} keyword, discussed here, is not yet implemented.

The {loop} keyword only applies when the {n} keyword is also used, and
controls how the molecules are generated in parallel.

If the setting is {all}, then every processor loops over all {N}
molecules.  As the coordinates of each is created, each processor
checks what grid cell it is in, and only stores the molecule if it
owns that grid cell.  Thus an identical set of molecules are created,
no matter how many processors are running the simulation

If the setting is {local}, then each of the {P} processors generates a
{N/P} subset of molecules, using its own random number generation.  It
only adds molecules to grid cells that it owns.  This is a faster way
to generate a large number of molecules, but means that the individual
attributes of molecules will depend on the number of processors and
the mapping of grid cells to procesors.  Statistically, the overall
set of created molecules should be the same as with the {all} setting.

:line

[Restrictions:]

A non-zero {Np} value for the {n} keyword cannot be used together with
the {single} keyword.

Particles are only inserted in grid cells which are entirely external
to surfaces.  I.e. grid cells cut by surfaces are not eligible for
insertion.

[Related commands:]

"mixture"_mixture.html, "fix inflow"_fix_inflow.html

[Default:]

The keyword default is n = 0.
