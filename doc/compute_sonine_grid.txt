"SPARTA WWW Site"_sws - "SPARTA Documentation"_sd - "SPARTA Commands"_sc :c

:link(sws,http://dsmc.sandia.gov)
:link(sd,Manual.html)
:link(sc,Section_commands.html#comm)

:line

compute sonine/grid command :h3

[Syntax:]

compute ID sonine/grid mix-ID keyword values ... :pre

ID is documented in "compute"_compute.html command :ulb,l
sonine/grid = style name of this compute command :l
mix-ID = mixture ID to perform calculation on :l
one or more keywords may be appended, multiple times :l
keyword = {thermal} or {a} or {b} :l
values = values for specific keyword :l
  {thermal} args = none = thermal temperature
  {a} args = dim order = sonine A moment
    dim = {x} or {y} or {z}
    order = number from 1 to 5
  {b} args = dim2 order = sonine B moment
    dim2 = {xx} or {yy} or {zz} or {xy} or {yz} or {xz}
    order = number from 1 to 5 :pre
:ule

[Examples:]

compute 1 sonine/grid species thermal a x 3 a z 3 b xy 3 b xz 3
compute 1 sonine/grid air a x 5 b xy 5 :pre

[Description:]

Define a computation that calculates the sonine moments of the
velocity distribution of the molecules in each grid cell.  The moments
are summed for each group of species in the specified mixture.  See
the "mixture"_mixture.html command for how a set of species can be
partitioned into groups.

Along with summing each specified value, a normalization factor is
also computed.  If the group has a single species, the normalization
factor is typically just the count of contributing molecules.  If the
group has mutlipe species, the normalization factor is typically the
total mass of the contributing molecules.  The normalization factors
are used by other commands that process values produced by this
compute.

For example, for the {a} value, the "dump grid"_dump.html command,
will generate the average sonine A moment for molecules in a grid
cell, averaged over molecules in the group.  The "fix
ave/grid"_fix_ave_grid.html command will generate the average sonine A
moment for molecules in a grid cell, averaged both over molecules in
the group and time.

:line

The {thermal} keyword computes the summed thermal kinetic energy for
all molecules in the group.  The normalization factor is 3 times the
count of molecules times the Boltzmann factor {kB}, so that the sum
divided by the normalization factor is the temperature {T}.

thermal_KE = Sum_i (1/2 mass_i Csq_i)
Csq = Cx*Cx + Cy*Cy + Cz*Cz
Cx = Vx - COMx
Cy = Vy - COMy
Cz = Vz - COMz
COMx = Sum_i (mass_i Vx_i) / Sum_i (mass_i)
COMy = Sum_i (mass_i Vy_i) / Sum_i (mass_i)
COMz = Sum_i (mass_i Vz_i) / Sum_i (mass_i)
3/2 kB T = thermal_KE :pre

Note that the thermal kinetic energy is calculated from {C} = the
thermal velocity of each molecule, which is its velocity minus the
center-of-mass (COM) velocity of molecules in that cell and group.
The COM velocity is the mass-weighted sum of the velocities of
molecules in the group divided by the total mass of the molecules.

:line

The {a} keyword calculates the sum of one or more sonine A moments for
all molecules in the group.  If the group has multiple species, the
sum is mass-weighted and the normalization factor is the total mass.

A1 = Sum_i (mass_i * Vdim * pow(Csq,1))
A2 = Sum_i (mass_i * Vdim * pow(Csq,2))
A3 = Sum_i (mass_i * Vdim * pow(Csq,3))
A4 = Sum_i (mass_i * Vdim * pow(Csq,4))
A5 = Sum_i (mass_i * Vdim * pow(Csq,5)) :pre

Vdim is Vx or Vy or Vz as specified by the {dim} value.  {Csq} is the
squared thermal velocity of the molecule and has the same meaning as
above in the {thermal} equations.  The number of moments computed is
specified by the {order} value.  If the group has a single species, no
mass weighting is done and the normalization factor is the count of
molecules.

The {b} keyword calculates the sum of one or more sonine B moments for
all molecules in the group.  If the group has multiple species, the
sum is mass-weighted and the normalization factor is the total mass.

B1 = Sum_i (mass_i * Vdim1 * Vdim2 * pow(Csq,1))
B2 = Sum_i (mass_i * Vdim1 * Vdim2 * pow(Csq,2))
B3 = Sum_i (mass_i * Vdim1 * Vdim2 * pow(Csq,3))
B4 = Sum_i (mass_i * Vdim1 * Vdim2 * pow(Csq,4))
B5 = Sum_i (mass_i * Vdim1 * Vdim2 * pow(Csq,5)) :pre

Vdim is Vx or Vy or Vz as specified by the {dim} value.  {Csq} is the
squared thermal velocity of the molecule and has the same meaning as
above in the {thermal} equations.  The number of moments computed is
specified by the {order} value.  If the group has a single species, no
mass weighting is done and the normalization factor is the count of
molecules.

:line

[Output info:]

This compute calculates a per-grid array, with the number of columns
is equal to the number of values times the number of groups.  The
ordering of columns is first by values, then by groups.  I.e. if the
{thermal} and {b xy 2} moments were specified as keywords, then the
1st thru 3rd columns would be the {thermal} and B1 and B2 moments of
the first group, the 4th thru 6th columns would be the {thermal} and
B1 and B2 moments of the second group, etc.

The array can be accessed by any command that uses per-grid values
from a compute as input.

The per-grid array values will be in the "units"_units.html
appropriate to the individual values as described above.  {Thermal} is
in temperature units.  A and B are in units like velocity cubed or
velocity to the 6th power.

[Restrictions:] none

[Related commands:]

"fix ave/grid"_fix_ave_grid.html, "dump grid"_dump.html

[Default:] none
