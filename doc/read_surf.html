<HTML>
<CENTER><A HREF = "http://dsmc.sandia.gov">DSMC WWW Site</A> - <A HREF = "Manual.html">DSMC Documentation</A> - <A HREF = "Section_commands.html#comm">DSMC Commands</A> 
</CENTER>






<HR>

<H3>read_surf command 
</H3>
<P><B>Syntax:</B>
</P>
<PRE>read_surf filename surfcoll-ID keyword args ... 
</PRE>
<UL><LI>filename = name of surface file 

<LI>surfcoll-ID = ID of surface collision model 

<LI>zero or more keyword/args pairs may be appended 

<LI>keyword = <I>origin</I> or <I>trans</I> or <I>atrans</I> or <I>ftrans</I> or <I>scale</I> or <I>rotate</I> or <I>invert</I> 

<PRE>  origin args = Ox Oy Oz
    Ox,Oy,Oz = set origin of surface to this point (distance units)
  trans args = Dx Dy Dz
    Dx,Dy,Dz = translate origin by this displacement (distance units)
  atrans args = Ax Ay Az
    Ax,Ax,Az = translate origin to this absolute point (distance units)
  ftrans args = Fx Fy Fz
    Fx,Fy,Fz = translate origin to this fractional point in simulation box
  scale args = Sx Sy Sz
    Sx,Sy,Sz = scale surface by these factors around origin
  rotate args = theta Rx Ry Rz
    theta = rotate surface by this angle in counter-clockwise direction (degrees)
    Rx,Ry,Rz = rotate around vector starting at origin pointing in this direction
  invert args = none 
</PRE>

</UL>
<P><B>Examples:</B>
</P>
<P>read_surf sphere surf.file
read_surf sphere surf.file origin 
</P>
<P><B>Description:</B>
</P>
<P>Read the geometry of one or more surfaces from a file.  In DSMC, a
"surface" is a grid of surface elements on the surface of a physical
object embedded in the global simulation box.  The surface elements
are triangles in 3d or line segments in 2d.  Particles collide with
surface elements as they advect, and optionally perform surface
chemistry during the collision.  Collision statistics for each surface
element are tallied, which can be ouput via the <A HREF = "dump.html">dump
surface</A> command.
</P>
<P>The surface file contains a list of triangles or line segments; DSMC
does not know or care whether they represent one or more physical
objects.
</P>
<P>All of the surface elements in the file are assigned a surfcoll-ID,
which is the ID of a surface collision model previously defined by the
<A HREF = "surf_collide.html">surf_collide</A> command.  This model will be used to
perform collisions when particles collide with the surface elements in
the surface.
</P>
<P>The format of the surface file is discussed below.  The optional
keywords allow the vertices in the file to be translated, scaled, and
rotated in various ways.  These allow a single input file, e.g. for a
unit sphere, to be used in a variety of simulations.
</P>
<HR>

<P>A surface file has a header and a body.  The header appears first.
The first line of the header is always skipped; it typically contains
a description of the file.  Then lines are read one at a time.  Lines
can have a trailing comment starting with '#' that is ignored.  If the
line is blank (only whitespace after comment is deleted), it is
skipped.  If the line contains a header keyword, the corresponding
value is read from the line.  If it doesn't contain a header keyword,
the line begins the body of the file.
</P>
<P>The body of the file contains two sections.  The first line of a
section has only a keyword.  The next line is skipped.  The remaining
lines of the section contain values.  The number of lines in a section
depends on the section keyword as described below.  Zero or more blank
lines can be used between sections.  Sections can appear in any order.
</P>
<P>The formatting of individual lines in the data file (indentation,
spacing between words and numbers) is not important except that header
and section keywords must be capitalized as shown and can't have extra
white space between their words.
</P>
<P>These are the recognized header keywords.  Header lines can come in
any order.  The value(s) are read from the beginning of the line.
Thus the keyword <I>points</I> should be in a line like "1000 points".
</P>
<UL><LI><I>points</I> = # of points in surface
<LI><I>lines</I> = # of line segments in surface (only allowed for 2d)
<LI><I>triangles</I> = # of triangles in surface (only allowed for 3d) 
</UL>
<P>These are the recognized section keywords for the body of the file.
</P>
<UL><LI><I>Points, Lines, Triangles</I> 
</UL>
<P>The <I>Points</I> section consists of N consecutive entries, where N = # of
points, each of this form:
</P>
<PRE>point-ID x y z    (for 3d) 
point-ID x y      (for 2d) 
</PRE>
<P>The point-ID is ignored; it is only added to assist in examining the
file.  The point-IDs should run consecutively from 1 to N.  <I>X,y,z</I>
are the coordinates of the point in distance units.  Note that for 2d
simulations, <I>z</I> should be omitted.
</P>
<P>The <I>Lines</I> section is only allowed for 2d simulations and consists of
N entries, where N = # of lines, each of this form:
</P>
<PRE>line-ID p1 p2 
</PRE>
<P>The line-ID is ignored; it is only added to assist in examining the
file.  <I>P1</I> and <I>p2</I> are the point-IDs of the 2 end points of the line
segment.  Each is a value from 1 to Npoints, as described above.
</P>
<P>The ordering of <I>p1</I> and <I>p2</I> is important as it defines the direction
of the outward normal for the line segment when a molecule collides
with it.  Molecules only collide with the "outer" edge of a line
segment.  This is defined by a right-hand rule.  The outward normal N
= (0,0,1) x (p2-p1).  In other words, a unit z-direction vector is
crossed into the vector from <I>p1</I> to <I>p2</I> to determine the normal.
</P>
<P>The <I>Triangles</I> section is only allowed for 3d simulations and
consists of N entries, where N = # of triangles, each of this form:
</P>
<PRE>tri-ID p1 p2 p3 
</PRE>
<P>The tri-ID is ignored; it is only added to assist in examining the
file.  <I>P1</I> and <I>p2</I> and <I>p3</I> are the point-IDs of the 3 corner points
of the triangle.  Each is a value from 1 to Npoints, as described
above.
</P>
<P>The ordering of <I>p1</I> and <I>p2</I> and <I>p3</I> is important as it defines the
direction of the outward normal for the triangle when a molecule
collides with it.  Molecules only collide with the "outer" face of a
triangle. This is defined by a right-hand rule.  The outward normal N
= (p2-p1) x (p3-p1).  In other words, the edge from <I>p1</I> to <I>p2</I> is
crossed into the edge from <I>p1</I> to <I>p3</I> to determine the normal.
</P>
<HR>

<P>The following optional keywords can be specified.  Their geometric
transformations are performed in the order they are listed, which
gives flexibility in how surfaces can be manipulated.  Note that the
order may be important; e.g. performing a <I>scale</I> followed by a
<I>rotate</I> may not be the same as a <I>rotate</I> followed by a <I>scale</I>.
</P>
<P>Most of the keywords perform a geometric transformation on all the
vertices in the surface file with respect to an origin point.  By
default the origin is (0.0,0.0,0.0), regardless of the position of
individual vertices in the file.
</P>
<P>The <I>origin</I> keyword resets the origin to the specified <I>Ox,Oy,Oz</I>.
This operation has no effect on the vertices.
</P>
<P>The <I>trans</I> keyword shifts or displaces the origin by the vector
(Dx,Dy,Dz).  It also displaces each vertex by (Dx,Dy,Dz).
</P>
<P>The <I>atrans</I> keyword resets the origin to an absolute point (Ax,Ay,Az)
which implies a displacement (Dx,Dy,Dz) from the current origin.  It
also displaces each vertex by (Dx,Dy,Dz).
</P>
<P>The <I>ftrans</I> keyword resets the origin to a fractional point
(Fx,Fy,Fz).  Fractional means that Fx = 0.0 is the lower edge/face in
the x-dimension and Fx = 1.0 is the upper edge/face in the
x-dimension, and similarly for Fy and Fz.  This change of origin
implies a displacement (Dx,Dy,Dz) from the current origin.  This
operation also displaces each vertex by (Dx,Dy,Dz).
</P>
<P>The <I>scale</I> keyword does not change the origin.  It computes the
displacement vector of each vertex from the origin (delx,dely,delz)
and scales that vector by (Sx,Sy,Sz), so that the new vertex
coordinate is (Ox + Sx*delx,Oy + Sy*dely,Oz + Sz*delz).
</P>
<P>The <I>rotate</I> keyword does not change the origin.  It rotates the
coordinates of all vertices by an angle <I>theta</I> in a counter-clockwise
direction, around the vector starting at the origin and pointing in
the direction <I>Rx,Ry,Rz</I>.  Any rotation can be represented by an
appropriate choice of origin, <I>theta</I> and (Rx,Ry,Rz).
</P>
<P>The <I>invert</I> keyword does not change the origin or any vertex
coordinates.  It flips the direction of the outward surface normal of
each surface element by changing the ordering of its vertices.  Since
particles only collide with the outer surface of a surface element,
this is a mechanism for using a surface files containing a single
sphere (for example) as either a sphere to embed in a flow field, or a
spherical outer boundary containing the flow.
</P>
<P><B>Restrictions:</B>
</P>
<P>This command can only be used after the simulation box is defined by
the <A HREF = "create_box.html">create_box</A> command, and after a grid has been
created by the <A HREF = "create_grid.html">create_grid</A> command.
</P>
<P>Every vertex in the final surface (after translation, rotation,
scaling, etc) must be inside the global simulation box.  Inside means
the vertex cannot be on the face of the simulation box, but must be
interior to the box.  This restriction will be relaxed at some point.
</P>
<P>The surface elements in a single surface file must represent a
"watertight" surface.  This means that no pair of vertices is within
an epsilon distance of each other.  Epsilon is defined as an EPSILON
fraction of the shortest simulation box length, where EPSILON is set
to 1.0e-6 in src/read_syrf.cpp.
</P>
<P>For a 3d simulation, "watertight" additionally requires that every
triangle edge is part of exactly 2 or 4 triangles.  For a 2d
simulation it requires that every vertex is part of exactly 2 or 4
line segments.  Thus if you want to model an infinitely thin object
(e.g. a plane) plate, you should grid it on both sides, using the same
vertices (this is why 4 triangles or line segments can border the same
edge or point).  Note that this definition of watertight does not
require that the surface elements in a file represent a single
physical object; multiple objects can be represented, provided each is
watertight.
</P>
<P>When running a simulation with multiple surfaces, read from one or
more surface files, you should insure they do not overlap/intersect
each other.  DSMC does not check for this, but it will typically lead
to unphysical particle dynamics.
</P>
<P><B>Related commands:</B> none
</P>
<P><B>Default:</B>
</P>
<P>The default origin for the vertices in the surface file is (0,0,0).
</P>
</HTML>
